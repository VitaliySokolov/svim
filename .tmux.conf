# Add binding to reload tmux.conf for fast, iterative development
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# unbind C-Space
# set -g prefix C-Space
# bind C-Space send-prefix

# unbind `
# set -g prefix `
# bind ` send-prefix

# Links
# https://github.com/tmux/tmux/wiki/Getting-Started
# https://tmuxcheatsheet.com/
# https://github.com/tmux-plugins/list

set -g mouse on
set-option -g history-limit 5000
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
setw -g mode-keys vi

set-option -g set-clipboard external

# Set vi-style key bindings for copy mode
set-window-option -g mode-keys vi

# Binding for Linux (xclip)
bind-key -T copy-mode-vi 'y' send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Binding for macOS (pbcopy)
# If using macOS, uncomment these lines and ensure reattach-to-user-namespace is installed via Homebrew
# bind-key -T copy-mode-vi 'y' send-keys -X copy-pipe-and-cancel 'pbcopy'
# bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel 'pbcopy'
# bind-key -T copy-mode-vi y send-keys -X copy-pipe if-shell "uname | grep -q Darwin" "echo 0" "echo 2"
# "xsel -i -p" "pbcopy"

bind | split-window -hc "#{pane_current_path}" # default %
bind-key "\\" split-window -fh -c "#{pane_current_path}"
bind - split-window -vc "#{pane_current_path}" # default "
bind-key "_" split-window -fv -c "#{pane_current_path}"

bind -r "<" swap-window -d -t -1
bind -r ">" swap-window -d -t +1

bind c new-window -c "#{pane_current_path}"

bind Space last-window
bind-key C-Space switch-client -l

bind -r C-j resize-pane -D 15
bind -r C-k resize-pane -U 15
bind -r C-h resize-pane -L 15
bind -r C-l resize-pane -R 15

bind j choose-window 'join-pane -h -s "%%"'
bind J choose-window 'join-pane -s "%%"'

# *Plugins*
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# Press <leader>+I to install plugins (it takes time)
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# set -g @plugin 'dracula/tmux'
# available plugins: battery, cpu-usage, git, gpu-usage, ram-usage, tmux-ram-usage, network, network-bandwidth, network-ping, ssh-session, attached-clients, network-vpn, weather, time, mpc, spotify-tui, krbtgt, playerctl, kubernetes-context, synchronize-panes
# set -g @dracula-plugins "time"
# set -g @dracula-time-format "%a %F %T"
# set -g @dracula-show-fahrenheit false
# set -g @dracula-show-location false

# https://github.com/nordtheme/tmux
# TODO: remove .tmux/plugins/tmux of dracula theme, prefix + alt + u
set -g @plugin "nordtheme/tmux"
set-window-option -g clock-mode-style 24

#
set -g @plugin 'alexwforsythe/tmux-which-key' # prefix + space
set -g @plugin 'tmux-plugins/tmux-yank'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-open' # todo: remove

set -g @plugin 'alberti42/tmux-fzf-links' # prefix + C-h
set-option -g @fzf-links-editor-open-cmd "tmux new-window -n 'nvim' nvim +%line '%file'"

set -g @plugin 'tmux-plugins/tmux-sidebar'
set -g @sidebar-tree-command 'tree -C'
set -g @sidebar-tree-focus 'E' # prefix + e
set -g @sidebar-tree 'e' # todo: change, default is prefix-Tab, which is used by extracto

set -g @plugin 'laktak/extrakto' # prefix + Tab, requires fzf
# set -g @plugin 'vndmp4/tmux-fzf-session-switch'

set -g @plugin 'christoomey/vim-tmux-navigator'

# plugin config
# set -g @continuum-restore 'on'

set -g status-left-length 50

# set -g default-terminal "${TERN}"
# set -sg terminal-overrides ",*:RGB"

# set -g status-style bg=default,fg=black,bright
# set -g status-left ""
# set -g status-right "#[fg=black,bright]#S"
# set -g window-status-format "*"

# set -g pane-border-lines simple
# set -g pane-border-style fg=black,bright
# set -g pane-active-border-style fg=magenta

bind-key "S" run-shell "t"

# set-option -g pane-active-border-style "fg=cyan,bg=cyan"
set-option -g pane-border-lines "double"

# set -g window-active-style 'fg=terminal,bg=terminal'
# set -g window-style 'fg=terminal,bg=black'
#
# set focus-events on
# set-hook -g client-focus-in "set window-active-style 'fg=terminal,bg=terminal'"
# set-hook -g client-focus-out "set window-active-style 'fg=terminal,bg=black'"

set -as terminal-features ",*:hyperlinks"

run '~/.tmux/plugins/tpm/tpm'
